<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Power Query Crash Course</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #111118;
    --surface2: #1a1a24;
    --accent: #f5a623;
    --accent2: #e85d4a;
    --accent3: #4acfe8;
    --text: #e8e8f0;
    --muted: #7070a0;
    --border: #2a2a3a;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Mono', monospace;
    font-size: 14px;
    line-height: 1.7;
    min-height: 100vh;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(245,166,35,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(245,166,35,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  .wrapper {
    max-width: 860px;
    margin: 0 auto;
    padding: 60px 24px 100px;
    position: relative;
    z-index: 1;
  }

  /* Hero */
  .hero { margin-bottom: 64px; animation: fadeUp 0.8s ease both; }

  .hero-label {
    font-size: 11px;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .hero-label::after {
    content: '';
    display: block;
    height: 1px;
    width: 60px;
    background: var(--accent);
    opacity: 0.5;
  }

  h1 {
    font-family: 'Syne', sans-serif;
    font-size: clamp(42px, 7vw, 72px);
    font-weight: 800;
    line-height: 0.95;
    letter-spacing: -0.03em;
    margin-bottom: 20px;
    color: var(--text);
  }

  h1 span { color: var(--accent); display: block; }

  .hero-sub { color: var(--muted); font-size: 13px; max-width: 480px; line-height: 1.8; }

  .progress-row { display: flex; gap: 4px; margin-top: 28px; }
  .prog-seg { height: 3px; flex: 1; border-radius: 2px; background: var(--border); overflow: hidden; }
  .prog-seg-fill { height: 100%; background: var(--accent); animation: fillBar 1.2s ease both; }
  .prog-seg:nth-child(1)  .prog-seg-fill { animation-delay: 0.10s; }
  .prog-seg:nth-child(2)  .prog-seg-fill { animation-delay: 0.20s; }
  .prog-seg:nth-child(3)  .prog-seg-fill { animation-delay: 0.30s; }
  .prog-seg:nth-child(4)  .prog-seg-fill { animation-delay: 0.40s; }
  .prog-seg:nth-child(5)  .prog-seg-fill { animation-delay: 0.50s; }
  .prog-seg:nth-child(6)  .prog-seg-fill { animation-delay: 0.60s; }
  .prog-seg:nth-child(7)  .prog-seg-fill { animation-delay: 0.70s; }
  .prog-seg:nth-child(8)  .prog-seg-fill { animation-delay: 0.80s; }
  .prog-seg:nth-child(9)  .prog-seg-fill { animation-delay: 0.90s; }
  .prog-seg:nth-child(10) .prog-seg-fill { animation-delay: 1.00s; }

  @keyframes fillBar { from { width: 0; } to { width: 100%; } }

  /* Sections */
  .section { margin-bottom: 48px; animation: fadeUp 0.6s ease both; }
  .section-header { display: flex; align-items: center; gap: 14px; margin-bottom: 20px; }

  .section-num {
    font-family: 'Syne', sans-serif;
    font-size: 11px;
    font-weight: 700;
    color: var(--accent);
    background: rgba(245,166,35,0.1);
    border: 1px solid rgba(245,166,35,0.2);
    width: 32px; height: 32px;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
    border-radius: 4px;
  }

  h2 { font-family: 'Syne', sans-serif; font-size: 20px; font-weight: 700; letter-spacing: -0.02em; color: var(--text); }

  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 24px 28px;
    transition: border-color 0.2s, box-shadow 0.2s;
  }

  .card:hover { border-color: rgba(245,166,35,0.3); box-shadow: 0 0 30px rgba(245,166,35,0.05); }

  p { color: var(--muted); margin-bottom: 12px; }
  p:last-child { margin-bottom: 0; }
  p strong { color: var(--text); font-weight: 500; }

  /* Grid */
  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }
  @media(max-width: 640px) { .grid-2, .grid-3 { grid-template-columns: 1fr; } }

  .mini-card {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 16px 18px;
    transition: transform 0.15s, border-color 0.2s;
  }

  .mini-card:hover { transform: translateY(-2px); border-color: rgba(74,207,232,0.3); }

  .mini-card-label { font-size: 11px; letter-spacing: 0.1em; text-transform: uppercase; color: var(--accent3); margin-bottom: 8px; font-weight: 500; }
  .mini-card p { font-size: 13px; margin: 0; }

  /* Code */
  .code-block {
    background: #0d0d15;
    border: 1px solid var(--border);
    border-left: 3px solid var(--accent3);
    border-radius: 6px;
    padding: 18px 20px;
    font-size: 12.5px;
    line-height: 1.9;
    overflow-x: auto;
    margin-top: 14px;
    font-family: 'DM Mono', monospace;
  }

  .code-label { font-size: 10px; letter-spacing: 0.18em; text-transform: uppercase; color: var(--muted); margin-bottom: 6px; margin-top: 16px; }

  .cc { color: #4a4a6a; font-style: italic; }
  .ck { color: var(--accent); }
  .cf { color: var(--accent3); }
  .cs { color: #8bc34a; }
  .cn { color: var(--accent2); }
  .cm { color: #c8c0f0; }

  /* Steps */
  .steps { display: flex; flex-direction: column; }
  .step { display: flex; gap: 18px; padding: 16px 0; border-bottom: 1px solid var(--border); }
  .step:last-child { border-bottom: none; }
  .step-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--accent); margin-top: 7px; flex-shrink: 0; box-shadow: 0 0 10px rgba(245,166,35,0.5); }
  .step-title { font-family: 'Syne', sans-serif; font-size: 14px; font-weight: 600; color: var(--text); margin-bottom: 4px; }
  .step-body { color: var(--muted); font-size: 13px; }

  /* Callouts */
  .tip {
    border: 1px solid rgba(74,207,232,0.2);
    background: rgba(74,207,232,0.04);
    border-radius: 6px;
    padding: 14px 18px;
    margin-top: 16px;
    font-size: 13px;
    color: var(--accent3);
    display: flex; gap: 10px; align-items: flex-start;
  }

  .warn {
    border: 1px solid rgba(232,93,74,0.2);
    background: rgba(232,93,74,0.04);
    border-radius: 6px;
    padding: 14px 18px;
    margin-top: 16px;
    font-size: 13px;
    color: var(--accent2);
    display: flex; gap: 10px; align-items: flex-start;
  }

  .tip-icon { flex-shrink: 0; margin-top: 1px; opacity: 0.7; }

  /* Tags */
  .tags { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 16px; }
  .tag { font-size: 11px; letter-spacing: 0.05em; padding: 5px 12px; border-radius: 100px; border: 1px solid; font-weight: 500; }
  .tag-y { color: var(--accent);  border-color: rgba(245,166,35,0.3); background: rgba(245,166,35,0.06); }
  .tag-r { color: var(--accent2); border-color: rgba(232,93,74,0.3);  background: rgba(232,93,74,0.06); }
  .tag-b { color: var(--accent3); border-color: rgba(74,207,232,0.3); background: rgba(74,207,232,0.06); }

  /* Table */
  .table-wrap { overflow-x: auto; }
  table { width: 100%; border-collapse: collapse; font-size: 13px; }
  th { text-align: left; padding: 10px 14px; font-family: 'Syne', sans-serif; font-size: 11px; letter-spacing: 0.12em; text-transform: uppercase; color: var(--muted); border-bottom: 1px solid var(--border); font-weight: 600; }
  td { padding: 12px 14px; border-bottom: 1px solid rgba(42,42,58,0.5); color: var(--muted); vertical-align: top; font-size: 13px; }
  td:first-child { color: var(--text); font-weight: 500; font-family: 'DM Mono', monospace; }
  tr:last-child td { border-bottom: none; }
  tr:hover td { background: rgba(255,255,255,0.015); }

  /* Pattern cards */
  .pattern { background: var(--surface); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 12px; overflow: hidden; }
  .pattern-header { display: flex; align-items: center; gap: 14px; padding: 14px 20px; background: var(--surface2); border-bottom: 1px solid var(--border); }
  .pattern-num { font-size: 10px; letter-spacing: 0.15em; color: var(--muted); font-weight: 700; flex-shrink: 0; }
  .pattern-title { font-family: 'Syne', sans-serif; font-size: 14px; font-weight: 600; color: var(--text); flex: 1; }
  .pattern-body { padding: 20px 20px 8px; }

  /* Checklist */
  .check-item { display: flex; gap: 14px; padding: 12px 0; border-bottom: 1px solid var(--border); font-size: 13px; color: var(--muted); align-items: flex-start; }
  .check-item:last-child { border-bottom: none; }
  .check-dot { width: 6px; height: 6px; border-radius: 50%; border: 1.5px solid var(--accent); margin-top: 6px; flex-shrink: 0; }
  .check-item strong { color: var(--text); }

  /* UI diagram */
  .ui-diagram {
    background: #0d0d15;
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 20px;
    margin-top: 16px;
    display: grid;
    grid-template-columns: 180px 1fr 200px;
    gap: 12px;
    font-size: 12px;
  }

  @media(max-width:640px) { .ui-diagram { grid-template-columns: 1fr; } }

  .ui-panel {
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 12px 14px;
    background: var(--surface);
  }

  .ui-panel-title {
    font-family: 'Syne', sans-serif;
    font-size: 10px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 10px;
    font-weight: 700;
  }

  .ui-item {
    font-size: 11.5px;
    color: var(--muted);
    padding: 5px 0;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .ui-item:last-child { border-bottom: none; }
  .ui-item-dot { width: 5px; height: 5px; border-radius: 50%; background: var(--accent3); flex-shrink: 0; }
  .ui-item-active { color: var(--text); }
  .ui-item-active .ui-item-dot { background: var(--accent); box-shadow: 0 0 6px rgba(245,166,35,0.5); }

  /* Footer */
  .footer { margin-top: 72px; padding-top: 24px; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px; font-size: 11px; color: var(--muted); letter-spacing: 0.05em; }
  .footer-badge { background: rgba(245,166,35,0.1); border: 1px solid rgba(245,166,35,0.2); color: var(--accent); padding: 5px 12px; border-radius: 4px; font-size: 11px; letter-spacing: 0.08em; font-family: 'Syne', sans-serif; font-weight: 700; }

  @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<div class="wrapper">

  <!-- Hero -->
  <div class="hero">
    <div class="hero-label">Deep Dive · Power BI</div>
    <h1>Power<span>Query</span></h1>
    <p class="hero-sub">The ETL engine inside Power BI. Connect, clean, shape, and combine data before it ever reaches your model.</p>
    <div class="progress-row">
      <div class="prog-seg"><div class="prog-seg-fill"></div></div>
      <div class="prog-seg"><div class="prog-seg-fill"></div></div>
      <div class="prog-seg"><div class="prog-seg-fill"></div></div>
      <div class="prog-seg"><div class="prog-seg-fill"></div></div>
      <div class="prog-seg"><div class="prog-seg-fill"></div></div>
      <div class="prog-seg"><div class="prog-seg-fill"></div></div>
      <div class="prog-seg"><div class="prog-seg-fill"></div></div>
      <div class="prog-seg"><div class="prog-seg-fill"></div></div>
      <div class="prog-seg"><div class="prog-seg-fill"></div></div>
      <div class="prog-seg"><div class="prog-seg-fill"></div></div>
    </div>
  </div>

  <!-- 01 What is Power Query -->
  <div class="section">
    <div class="section-header">
      <div class="section-num">01</div>
      <h2>What is Power Query?</h2>
    </div>
    <div class="card">
      <p><strong>Power Query</strong> is the data transformation engine built into Power BI (and Excel). It sits between your raw data sources and your data model — connecting, cleaning, and shaping data before it's loaded.</p>
      <p>Every transformation you apply is recorded as a <strong>step</strong> and generates M code behind the scenes. These steps replay automatically on every refresh, making your data pipeline fully repeatable.</p>
      <div class="grid-3" style="margin-top:16px;">
        <div class="mini-card">
          <div class="mini-card-label">Connect</div>
          <p>100+ built-in connectors — files, databases, APIs, cloud services, and more.</p>
        </div>
        <div class="mini-card">
          <div class="mini-card-label">Transform</div>
          <p>Clean, reshape, filter, merge, and type-cast data using a visual step-by-step editor.</p>
        </div>
        <div class="mini-card">
          <div class="mini-card-label">Load</div>
          <p>Send the cleaned result to the Power BI data model, or to a staging query for reuse.</p>
        </div>
      </div>
      <div class="tip">
        <span class="tip-icon">→</span>
        <span>Power Query is for <strong>shaping data</strong>. Calculations and aggregations belong in DAX measures — not here. Keep the two responsibilities separate.</span>
      </div>
    </div>
  </div>

  <!-- 02 The Editor -->
  <div class="section">
    <div class="section-header">
      <div class="section-num">02</div>
      <h2>The Power Query Editor</h2>
    </div>
    <div class="card">
      <p>Open the editor via <strong>Home → Transform Data</strong> in Power BI Desktop. It has four key panels:</p>
      <div class="ui-diagram">
        <div class="ui-panel">
          <div class="ui-panel-title">Queries</div>
          <div class="ui-item ui-item-active"><div class="ui-item-dot"></div>Sales</div>
          <div class="ui-item ui-item-active"><div class="ui-item-dot"></div>Customers</div>
          <div class="ui-item"><div class="ui-item-dot"></div>Products</div>
          <div class="ui-item"><div class="ui-item-dot"></div>DimDate</div>
          <div class="ui-item"><div class="ui-item-dot"></div>_Params</div>
        </div>
        <div class="ui-panel">
          <div class="ui-panel-title">Data Preview</div>
          <div class="ui-item"><div class="ui-item-dot"></div>Column headers with type icons</div>
          <div class="ui-item"><div class="ui-item-dot"></div>Row-by-row data sample</div>
          <div class="ui-item"><div class="ui-item-dot"></div>Right-click columns for transforms</div>
          <div class="ui-item"><div class="ui-item-dot"></div>Column profiling (errors, distinct)</div>
        </div>
        <div class="ui-panel">
          <div class="ui-panel-title">Applied Steps</div>
          <div class="ui-item"><div class="ui-item-dot"></div>Source</div>
          <div class="ui-item"><div class="ui-item-dot"></div>Navigation</div>
          <div class="ui-item"><div class="ui-item-dot"></div>Changed Type</div>
          <div class="ui-item ui-item-active"><div class="ui-item-dot"></div>Filtered Rows</div>
          <div class="ui-item"><div class="ui-item-dot"></div>Renamed Columns</div>
        </div>
      </div>
      <div class="tip" style="margin-top:16px;">
        <span class="tip-icon">→</span>
        <span>Enable <strong>View → Column Quality</strong>, <strong>Column Distribution</strong>, and <strong>Column Profile</strong> to instantly spot nulls, errors, and duplicates in your data.</span>
      </div>
    </div>
  </div>

  <!-- 03 Connecting to Data -->
  <div class="section">
    <div class="section-header">
      <div class="section-num">03</div>
      <h2>Connecting to Data Sources</h2>
    </div>
    <div class="card">
      <p>Use <strong>Home → Get Data</strong> to browse all available connectors. Power Query supports over 100 sources across these categories:</p>
      <div class="tags">
        <span class="tag tag-y">Excel / CSV / JSON / XML</span>
        <span class="tag tag-y">SQL Server / PostgreSQL / MySQL</span>
        <span class="tag tag-y">SharePoint / OneDrive</span>
        <span class="tag tag-b">Azure SQL / Blob / Data Lake</span>
        <span class="tag tag-b">Salesforce / Dynamics 365</span>
        <span class="tag tag-b">Google Analytics / BigQuery</span>
        <span class="tag tag-r">REST API (Web connector)</span>
        <span class="tag tag-r">OData feeds</span>
        <span class="tag tag-r">Folder (combine multiple files)</span>
      </div>
      <div class="warn" style="margin-top:16px;">
        <span class="tip-icon">!</span>
        <span>When connecting to files, always use <strong>relative paths or parameters</strong> — avoid hardcoded local paths that break when the file moves or someone else opens the report.</span>
      </div>
      <div class="code-label">Connecting to a folder of CSV files (M)</div>
      <div class="code-block">
<span class="cc">// Combine all CSVs in a folder automatically</span><br>
<span class="ck">let</span><br>
&nbsp;&nbsp;Source    = <span class="cf">Folder.Files</span>(<span class="cs">"C:\Data\Sales"</span>),<br>
&nbsp;&nbsp;CsvOnly   = <span class="cf">Table.SelectRows</span>(Source, <span class="ck">each</span> [Extension] = <span class="cs">".csv"</span>),<br>
&nbsp;&nbsp;Combined  = <span class="cf">Table.Combine</span>(<span class="cf">List.Transform</span>(CsvOnly[Content],<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ck">each</span> <span class="cf">Csv.Document</span>(_, [Delimiter=<span class="cs">","</span>, Encoding=<span class="cn">65001</span>])))<br>
<span class="ck">in</span><br>
&nbsp;&nbsp;Combined
      </div>
    </div>
  </div>

  <!-- 04 Essential Transformations -->
  <div class="section">
    <div class="section-header">
      <div class="section-num">04</div>
      <h2>Essential Transformations</h2>
    </div>
    <div class="card">
      <div class="steps">
        <div class="step">
          <div class="step-dot"></div>
          <div>
            <div class="step-title">Change Data Types</div>
            <div class="step-body">Always set explicit types — date, number, text, logical. Power Query auto-detects but often gets it wrong. Right-click the column header → Change Type, or use the type icon in the header. This should be one of your first steps.</div>
          </div>
        </div>
        <div class="step">
          <div class="step-dot"></div>
          <div>
            <div class="step-title">Filter Rows</div>
            <div class="step-body">Click the dropdown arrow on any column header to filter by value, condition, or type. Remove nulls, blanks, errors, or rows that don't meet your criteria. Filters are applied as a step and replayed on refresh.</div>
          </div>
        </div>
        <div class="step">
          <div class="step-dot"></div>
          <div>
            <div class="step-title">Remove / Rename Columns</div>
            <div class="step-body">Right-click columns to remove or rename them. Use <strong>Choose Columns</strong> to keep only what you need. Fewer columns = smaller model size = faster performance.</div>
          </div>
        </div>
        <div class="step">
          <div class="step-dot"></div>
          <div>
            <div class="step-title">Split & Extract</div>
            <div class="step-body">Split columns by delimiter, character count, or position. Extract text before/after a delimiter, first/last N characters, or between delimiters. All available under <strong>Transform → Column</strong>.</div>
          </div>
        </div>
        <div class="step">
          <div class="step-dot"></div>
          <div>
            <div class="step-title">Replace Values</div>
            <div class="step-body">Replace specific values or nulls in a column. Useful for standardising inconsistent entries like "N/A", "n/a", "-" all meaning null.</div>
          </div>
        </div>
        <div class="step">
          <div class="step-dot"></div>
          <div>
            <div class="step-title">Pivot & Unpivot</div>
            <div class="step-body"><strong>Unpivot</strong> is one of the most powerful tools — it turns wide "crosstab" tables (months as columns) into long "tidy" tables (one row per month). Select the columns to keep, then Transform → Unpivot Other Columns.</div>
          </div>
        </div>
        <div class="step">
          <div class="step-dot"></div>
          <div>
            <div class="step-title">Group By</div>
            <div class="step-body">Aggregate rows by one or more columns. Equivalent to a SQL GROUP BY — sum, count, average, min, max, or all rows. Found under <strong>Home → Group By</strong>.</div>
          </div>
        </div>
        <div class="step">
          <div class="step-dot"></div>
          <div>
            <div class="step-title">Add Custom Column</div>
            <div class="step-body">Add a new column using M formula logic — conditional logic, text concatenation, arithmetic. Found under <strong>Add Column → Custom Column</strong>.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 05 Merge & Append -->
  <div class="section">
    <div class="section-header">
      <div class="section-num">05</div>
      <h2>Merge & Append Queries</h2>
    </div>
    <div class="card">
      <div class="grid-2" style="margin-bottom:16px;">
        <div class="mini-card">
          <div class="mini-card-label">Merge (JOIN)</div>
          <p>Combine two tables horizontally on a matching key column. Equivalent to SQL JOIN. Supports Left Outer, Inner, Right Outer, Full Outer, Left Anti, Right Anti.</p>
        </div>
        <div class="mini-card">
          <div class="mini-card-label">Append (UNION)</div>
          <p>Stack two or more tables vertically with the same columns. Equivalent to SQL UNION ALL. Great for combining monthly export files.</p>
        </div>
      </div>
      <div class="code-label">Merge example (Left Outer Join in M)</div>
      <div class="code-block">
<span class="ck">let</span><br>
&nbsp;&nbsp;Source    = Sales,<br>
&nbsp;&nbsp;Merged    = <span class="cf">Table.NestedJoin</span>(<br>
&nbsp;&nbsp;&nbsp;&nbsp;Source, {<span class="cs">"CustomerID"</span>},<br>
&nbsp;&nbsp;&nbsp;&nbsp;Customers, {<span class="cs">"ID"</span>},<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs">"CustomerData"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;JoinKind.LeftOuter<br>
&nbsp;&nbsp;),<br>
&nbsp;&nbsp;Expanded  = <span class="cf">Table.ExpandTableColumn</span>(<br>
&nbsp;&nbsp;&nbsp;&nbsp;Merged, <span class="cs">"CustomerData"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="cs">"Name"</span>, <span class="cs">"Region"</span>, <span class="cs">"Segment"</span>}<br>
&nbsp;&nbsp;)<br>
<span class="ck">in</span><br>
&nbsp;&nbsp;Expanded
      </div>
      <div class="tip">
        <span class="tip-icon">→</span>
        <span>In most cases, <strong>don't merge in Power Query</strong> when you can define a relationship in the data model instead. Model relationships are more flexible and performant. Merge only when you genuinely need to denormalise.</span>
      </div>
    </div>
  </div>

  <!-- 06 M Language -->
  <div class="section">
    <div class="section-header">
      <div class="section-num">06</div>
      <h2>The M Language</h2>
    </div>
    <div class="card">
      <p>Every transformation in Power Query generates <strong>M code</strong>. M is a functional, case-sensitive language. You rarely need to write it by hand — but reading and editing it gives you precise control.</p>
      <p>View the M for any query via <strong>Home → Advanced Editor</strong>.</p>
      <div class="code-label">M structure — every query follows this pattern</div>
      <div class="code-block">
<span class="ck">let</span><br>
&nbsp;&nbsp;<span class="cc">// Each line is a named step</span><br>
&nbsp;&nbsp;Source        = <span class="cf">Excel.Workbook</span>(<span class="cf">File.Contents</span>(<span class="cs">"data.xlsx"</span>), <span class="ck">true</span>),<br>
&nbsp;&nbsp;Sheet         = Source{[Name=<span class="cs">"Sales"</span>]}[Data],<br>
&nbsp;&nbsp;PromotedHeaders = <span class="cf">Table.PromoteHeaders</span>(Sheet, [PromoteAllScalars=<span class="ck">true</span>]),<br>
&nbsp;&nbsp;ChangedTypes  = <span class="cf">Table.TransformColumnTypes</span>(PromotedHeaders, {<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="cs">"Date"</span>, <span class="ck">type date</span>},<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="cs">"Amount"</span>, <span class="ck">type number</span>},<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="cs">"Product"</span>, <span class="ck">type text</span>}<br>
&nbsp;&nbsp;}),<br>
&nbsp;&nbsp;FilteredRows  = <span class="cf">Table.SelectRows</span>(ChangedTypes, <span class="ck">each</span> [Amount] > <span class="cn">0</span>),<br>
&nbsp;&nbsp;RenamedCols   = <span class="cf">Table.RenameColumns</span>(FilteredRows, {{<span class="cs">"Amount"</span>, <span class="cs">"Revenue"</span>}})<br>
<span class="ck">in</span><br>
&nbsp;&nbsp;RenamedCols <span class="cc">// &lt;— this is what gets loaded</span>
      </div>
      <div class="code-label">Useful M patterns</div>
      <div class="code-block">
<span class="cc">// Conditional column</span><br>
<span class="cf">Table.AddColumn</span>(Source, <span class="cs">"Tier"</span>, <span class="ck">each</span><br>
&nbsp;&nbsp;<span class="ck">if</span> [Revenue] > <span class="cn">10000</span> <span class="ck">then</span> <span class="cs">"Gold"</span><br>
&nbsp;&nbsp;<span class="ck">else if</span> [Revenue] > <span class="cn">5000</span>  <span class="ck">then</span> <span class="cs">"Silver"</span><br>
&nbsp;&nbsp;<span class="ck">else</span> <span class="cs">"Bronze"</span><br>
)<br><br>
<span class="cc">// Trim and clean text</span><br>
<span class="cf">Table.TransformColumns</span>(Source, {{<span class="cs">"Name"</span>, <span class="ck">each</span> <span class="cf">Text.Trim</span>(<span class="cf">Text.Clean</span>(_)), <span class="ck">type text</span>}})<br><br>
<span class="cc">// Extract year from date column</span><br>
<span class="cf">Table.AddColumn</span>(Source, <span class="cs">"Year"</span>, <span class="ck">each</span> <span class="cf">Date.Year</span>([OrderDate]), <span class="ck">Int64.Type</span>)<br><br>
<span class="cc">// Replace nulls with a default value</span><br>
<span class="cf">Table.ReplaceValue</span>(Source, <span class="ck">null</span>, <span class="cn">0</span>, <span class="cf">Replacer.ReplaceValue</span>, {<span class="cs">"Discount"</span>})
      </div>
    </div>
  </div>

  <!-- 07 Parameters -->
  <div class="section">
    <div class="section-header">
      <div class="section-num">07</div>
      <h2>Parameters & Dynamic Queries</h2>
    </div>
    <div class="card">
      <p><strong>Parameters</strong> let you make queries dynamic — changing file paths, filter values, server names, or date ranges without editing the M code directly.</p>
      <p>Create them via <strong>Home → Manage Parameters → New Parameter</strong>. Parameters can be text, number, date, logical, or a list.</p>
      <div class="code-label">Using a parameter in a query</div>
      <div class="code-block">
<span class="cc">// Parameter: StartDate (type = date)</span><br>
<span class="ck">let</span><br>
&nbsp;&nbsp;Source      = Sales,<br>
&nbsp;&nbsp;Filtered    = <span class="cf">Table.SelectRows</span>(Source,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="ck">each</span> [OrderDate] >= StartDate<br>
&nbsp;&nbsp;)<br>
<span class="ck">in</span><br>
&nbsp;&nbsp;Filtered<br><br>
<span class="cc">// Parameter: FilePath (type = text)</span><br>
<span class="ck">let</span><br>
&nbsp;&nbsp;Source = <span class="cf">Excel.Workbook</span>(<span class="cf">File.Contents</span>(FilePath), <span class="ck">true</span>)<br>
<span class="ck">in</span><br>
&nbsp;&nbsp;Source
      </div>
      <div class="tip">
        <span class="tip-icon">→</span>
        <span>Pair parameters with a <strong>Parameters table</strong> in Excel or SharePoint — then read the parameter value from that table at refresh time, making your report configurable without opening Power BI Desktop.</span>
      </div>
    </div>
  </div>

  <!-- 08 Query Folding -->
  <div class="section">
    <div class="section-header">
      <div class="section-num">08</div>
      <h2>Query Folding</h2>
    </div>
    <div class="card">
      <p><strong>Query folding</strong> is when Power Query translates your transformation steps into a native query (SQL, OData, etc.) and pushes it to the data source to execute — rather than pulling all data into Power BI and processing it locally.</p>
      <p>This massively improves performance on large datasets. The source does the heavy lifting; Power BI only receives the filtered, shaped result.</p>
      <div class="grid-2" style="margin-top:16px;">
        <div class="mini-card">
          <div class="mini-card-label">Folds (fast)</div>
          <p>Filter rows, remove columns, change types, group by, sort, merge — when applied to database sources like SQL Server.</p>
        </div>
        <div class="mini-card">
          <div class="mini-card-label">Breaks folding (slow)</div>
          <p>Adding index columns, custom M functions, Table.Buffer(), or any step that can't be expressed in native SQL.</p>
        </div>
      </div>
      <div class="warn">
        <span class="tip-icon">!</span>
        <span>Right-click any step in Applied Steps and check if <strong>"View Native Query"</strong> is available — if it's greyed out, folding has broken at that step. Move non-foldable steps as late as possible.</span>
      </div>
    </div>
  </div>

  <!-- 09 Reference vs Duplicate -->
  <div class="section">
    <div class="section-header">
      <div class="section-num">09</div>
      <h2>M Function Quick Reference</h2>
    </div>
    <div class="card" style="padding:0; overflow:hidden;">
      <div class="table-wrap">
        <table>
          <thead>
            <tr><th>Function</th><th>Category</th><th>What It Does</th></tr>
          </thead>
          <tbody>
            <tr><td>Table.SelectRows</td><td><span class="tag tag-y" style="font-size:10px;padding:3px 10px;">Filter</span></td><td>Keep rows matching a condition (WHERE)</td></tr>
            <tr><td>Table.SelectColumns</td><td><span class="tag tag-y" style="font-size:10px;padding:3px 10px;">Filter</span></td><td>Keep only specified columns</td></tr>
            <tr><td>Table.RemoveColumns</td><td><span class="tag tag-y" style="font-size:10px;padding:3px 10px;">Filter</span></td><td>Drop specified columns</td></tr>
            <tr><td>Table.RenameColumns</td><td><span class="tag tag-b" style="font-size:10px;padding:3px 10px;">Transform</span></td><td>Rename one or more columns</td></tr>
            <tr><td>Table.TransformColumnTypes</td><td><span class="tag tag-b" style="font-size:10px;padding:3px 10px;">Transform</span></td><td>Set data types for columns</td></tr>
            <tr><td>Table.TransformColumns</td><td><span class="tag tag-b" style="font-size:10px;padding:3px 10px;">Transform</span></td><td>Apply a function to each value in a column</td></tr>
            <tr><td>Table.AddColumn</td><td><span class="tag tag-b" style="font-size:10px;padding:3px 10px;">Transform</span></td><td>Add a new column with a custom formula</td></tr>
            <tr><td>Table.ReplaceValue</td><td><span class="tag tag-b" style="font-size:10px;padding:3px 10px;">Transform</span></td><td>Replace specific values or nulls in a column</td></tr>
            <tr><td>Table.SplitColumn</td><td><span class="tag tag-b" style="font-size:10px;padding:3px 10px;">Transform</span></td><td>Split a column by delimiter or position</td></tr>
            <tr><td>Table.UnpivotOtherColumns</td><td><span class="tag tag-r" style="font-size:10px;padding:3px 10px;">Reshape</span></td><td>Turn wide table to long/tidy format</td></tr>
            <tr><td>Table.Pivot</td><td><span class="tag tag-r" style="font-size:10px;padding:3px 10px;">Reshape</span></td><td>Turn distinct values in a column into headers</td></tr>
            <tr><td>Table.Group</td><td><span class="tag tag-r" style="font-size:10px;padding:3px 10px;">Reshape</span></td><td>Group rows and aggregate (GROUP BY)</td></tr>
            <tr><td>Table.NestedJoin</td><td><span class="tag tag-r" style="font-size:10px;padding:3px 10px;">Reshape</span></td><td>Merge two tables on a key (JOIN)</td></tr>
            <tr><td>Table.Combine</td><td><span class="tag tag-r" style="font-size:10px;padding:3px 10px;">Reshape</span></td><td>Stack tables vertically (UNION ALL)</td></tr>
            <tr><td>Table.AddIndexColumn</td><td><span class="tag tag-b" style="font-size:10px;padding:3px 10px;">Transform</span></td><td>Add an auto-incrementing index column</td></tr>
            <tr><td>Table.RemoveDuplicates</td><td><span class="tag tag-y" style="font-size:10px;padding:3px 10px;">Filter</span></td><td>Remove duplicate rows based on columns</td></tr>
            <tr><td>Table.Sort</td><td><span class="tag tag-b" style="font-size:10px;padding:3px 10px;">Transform</span></td><td>Sort rows by one or more columns</td></tr>
            <tr><td>Text.Trim / Text.Clean</td><td><span class="tag tag-b" style="font-size:10px;padding:3px 10px;">Text</span></td><td>Remove whitespace / non-printable characters</td></tr>
            <tr><td>Date.Year / Month / Day</td><td><span class="tag tag-r" style="font-size:10px;padding:3px 10px;">Date</span></td><td>Extract date parts from a date value</td></tr>
            <tr><td>List.Distinct / List.Sum</td><td><span class="tag tag-b" style="font-size:10px;padding:3px 10px;">List</span></td><td>Work with list values inside table cells</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- 10 Best Practices -->
  <div class="section">
    <div class="section-header">
      <div class="section-num">10</div>
      <h2>Best Practices Checklist</h2>
    </div>
    <div class="card">
      <div class="check-item">
        <div class="check-dot"></div>
        <span><strong>Set data types explicitly on every column</strong> — never rely on auto-detection. Incorrect types cause silent errors downstream in DAX.</span>
      </div>
      <div class="check-item">
        <div class="check-dot"></div>
        <span><strong>Remove columns you don't need early</strong> — fewer columns loaded means a smaller model, faster refresh, and less RAM consumed.</span>
      </div>
      <div class="check-item">
        <div class="check-dot"></div>
        <span><strong>Don't load staging queries to the model</strong> — right-click any helper/intermediate query → "Enable Load" to uncheck it. It runs but won't bloat your model.</span>
      </div>
      <div class="check-item">
        <div class="check-dot"></div>
        <span><strong>Use Reference instead of Duplicate</strong> — Reference creates a query that depends on the original (changes cascade). Duplicate copies the M code independently. Use Reference for staging chains.</span>
      </div>
      <div class="check-item">
        <div class="check-dot"></div>
        <span><strong>Preserve query folding</strong> — apply filters and column removals before any step that breaks folding. Keep non-foldable steps at the end.</span>
      </div>
      <div class="check-item">
        <div class="check-dot"></div>
        <span><strong>Use parameters for file paths and filter values</strong> — never hardcode paths or threshold values directly in M code.</span>
      </div>
      <div class="check-item">
        <div class="check-dot"></div>
        <span><strong>Name your steps clearly</strong> — double-click any Applied Step to rename it. "FilteredRows" is unhelpful; "RemoveReturns" tells you exactly what happened.</span>
      </div>
      <div class="check-item">
        <div class="check-dot"></div>
        <span><strong>Use Table.Buffer() sparingly</strong> — it forces evaluation and breaks folding. Only use it when a query is referenced multiple times and you want to avoid repeated evaluation.</span>
      </div>
      <div class="check-item">
        <div class="check-dot"></div>
        <span><strong>Keep Power Query for shaping, not calculating</strong> — computed aggregates and business logic belong in DAX measures, not custom columns in Power Query.</span>
      </div>
      <div class="check-item">
        <div class="check-dot"></div>
        <span><strong>Use the Diagnostics tools for slow refreshes</strong> — Tools → Start Diagnostics captures query-level timing so you can pinpoint which query is the bottleneck.</span>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <span>Power Query Crash Course · Power BI Deep Dive Series</span>
    <span class="footer-badge">10 MODULES</span>
  </div>

</div>
</body>
</html>
